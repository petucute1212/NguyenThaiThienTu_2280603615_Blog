<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8" />
    <title>X√¢y d·ª±ng Mini FTP Server trong Java</title>
    <link rel="stylesheet" href="../css/style.css" />
</head>
<body>
    <header>
        <h1>X√¢y d·ª±ng Mini FTP Server trong Java</h1>
        <nav><a href="../index.html">‚á† Tr·ªü v·ªÅ trang ch·ªß</a></nav>
    </header>

    <main>
        <p style="color: #d4af37; font-size: 1.1em; margin-bottom: 25px;"><b>üìÖ Ng√†y ƒëƒÉng:</b> 24/10/2025</p>

        <section>
            <h2>1. Gi·ªõi thi·ªáu v·ªÅ FTP v√† Mini FTP Server</h2>
            <p>
                FTP (File Transfer Protocol) l√† giao th·ª©c ph·ªï bi·∫øn ƒë·ªÉ trao ƒë·ªïi file gi·ªØa client v√† server.  
                Trong b√†i n√†y, ta s·∫Ω x√¢y d·ª±ng m·ªôt phi√™n b·∫£n thu nh·ªè ‚Äî g·ªçi l√† <b>Mini FTP Server</b> ‚Äî 
                cho ph√©p client g·ª≠i l·ªánh ƒë·ªÉ t·∫£i l√™n, t·∫£i xu·ªëng ho·∫∑c xem danh s√°ch file c√≥ tr√™n server.
            </p>
            
            <h3>1.1. FTP - File Transfer Protocol</h3>
            <p>
                FTP ƒë∆∞·ª£c ph√°t tri·ªÉn v√†o nƒÉm 1971 v√† v·∫´n l√† giao th·ª©c ph·ªï bi·∫øn cho vi·ªác chuy·ªÉn file:
            </p>
            <ul>
                <li><b>Standard FTP:</b> D√πng port 21 (command) v√† port 20 (data)</li>
                <li><b>SFTP (SSH File Transfer Protocol):</b> An to√†n h∆°n, d√πng SSH</li>
                <li><b>FTPS:</b> FTP over SSL/TLS</li>
            </ul>
            
            <h3>1.2. ·ª®ng d·ª•ng th·ª±c t·∫ø c·ªßa FTP</h3>
            <ul>
                <li>Web hosting: Upload website files l√™n server</li>
                <li>Share files trong n·ªôi b·ªô c√¥ng ty</li>
                <li>Backup t·ª± ƒë·ªông d·ªØ li·ªáu</li>
                <li>Distribute software v√† updates</li>
                <li>Media server chia s·∫ª ·∫£nh, video</li>
            </ul>
            
            <h3>1.3. T√≠nh nƒÉng c·ªßa Mini FTP Server</h3>
            <p>
                Phi√™n b·∫£n Mini FTP c·ªßa ch√∫ng ta s·∫Ω h·ªó tr·ª£:
            </p>
            <ul>
                <li>‚úÖ <b>LIST:</b> Li·ªát k√™ t·∫•t c·∫£ file trong th∆∞ m·ª•c server</li>
                <li>‚úÖ <b>GET &lt;filename&gt;:</b> Download file t·ª´ server v·ªÅ client</li>
                <li>‚úÖ <b>PUT &lt;filename&gt;:</b> Upload file t·ª´ client l√™n server</li>
                <li>‚úÖ <b>EXIT:</b> ƒê√≥ng k·∫øt n·ªëi an to√†n</li>
            </ul>
            
            <p>
                <b>L∆∞u √Ω:</b> ƒê√¢y l√† phi√™n b·∫£n ƒë∆°n gi·∫£n, kh√¥ng h·ªó tr·ª£:
            </p>
            <ul>
                <li>Authentication (username/password)</li>
                <li>Multiple directories (ch·ªâ 1 th∆∞ m·ª•c root)</li>
                <li>Delete, rename, create directory</li>
                <li>Progress indicator khi transfer</li>
            </ul>
        </section>

        <section>
            <h2>2. Ki·∫øn tr√∫c t·ªïng th·ªÉ</h2>
            <ul>
                <li>Server ch·∫°y li√™n t·ª•c, ch·ªù client k·∫øt n·ªëi qua TCP (port c·ªë ƒë·ªãnh, v√≠ d·ª• 2121).</li>
                <li>Client g·ª≠i l·ªánh text: <code>LIST</code>, <code>GET filename</code>, <code>PUT filename</code>, <code>EXIT</code>.</li>
                <li>Server ƒë·ªçc l·ªánh, ph·∫£n h·ªìi k·∫øt qu·∫£ ho·∫∑c d·ªØ li·ªáu file t∆∞∆°ng ·ª©ng.</li>
                <li>C√°c file ƒë∆∞·ª£c l∆∞u tr·ªØ trong th∆∞ m·ª•c g·ªëc c·ªßa server (v√≠ d·ª•: <code>server_files/</code>).</li>
            </ul>
        </section>

        <section>
            <h2>3. M√£ ngu·ªìn minh h·ªça</h2>

            <h3>FTPServer.java</h3>
            <pre><code>
import java.io.*;
import java.net.*;
import java.util.*;

public class FTPServer {
    private static final int PORT = 2121;
    private static final String ROOT_DIR = "server_files";

    public static void main(String[] args) throws IOException {
        ServerSocket serverSocket = new ServerSocket(PORT);
        System.out.println("Mini FTP Server ƒëang ch·∫°y tr√™n c·ªïng " + PORT);

        while (true) {
            Socket clientSocket = serverSocket.accept();
            System.out.println("Client k·∫øt n·ªëi: " + clientSocket.getInetAddress());
            new ClientHandler(clientSocket).start();
        }
    }

    private static class ClientHandler extends Thread {
        private Socket socket;

        public ClientHandler(Socket socket) {
            this.socket = socket;
        }

        public void run() {
            try {
                BufferedReader in = new BufferedReader(new InputStreamReader(socket.getInputStream()));
                PrintWriter out = new PrintWriter(socket.getOutputStream(), true);
                DataInputStream dataIn = new DataInputStream(socket.getInputStream());
                DataOutputStream dataOut = new DataOutputStream(socket.getOutputStream());

                out.println("K·∫øt n·ªëi th√†nh c√¥ng. Nh·∫≠p l·ªánh (LIST, GET, PUT, EXIT):");

                while (true) {
                    String command = in.readLine();
                    if (command == null) break;

                    if (command.equalsIgnoreCase("LIST")) {
                        File folder = new File(ROOT_DIR);
                        File[] files = folder.listFiles();
                        if (files == null || files.length == 0) {
                            out.println("Th∆∞ m·ª•c r·ªóng.");
                        } else {
                            out.println("Danh s√°ch file:");
                            for (File f : files) {
                                out.println(" - " + f.getName());
                            }
                        }

                    } else if (command.startsWith("GET ")) {
                        String filename = command.substring(4).trim();
                        File file = new File(ROOT_DIR + "/" + filename);
                        if (!file.exists()) {
                            out.println("File kh√¥ng t·ªìn t·∫°i.");
                            continue;
                        }

                        out.println("SENDING " + file.length());
                        FileInputStream fis = new FileInputStream(file);
                        byte[] buffer = new byte[4096];
                        int count;
                        while ((count = fis.read(buffer)) > 0) {
                            dataOut.write(buffer, 0, count);
                        }
                        fis.close();
                        out.println("DONE");

                    } else if (command.startsWith("PUT ")) {
                        String filename = command.substring(4).trim();
                        File file = new File(ROOT_DIR + "/" + filename);
                        out.println("READY");

                        long fileSize = Long.parseLong(in.readLine());
                        FileOutputStream fos = new FileOutputStream(file);
                        byte[] buffer = new byte[4096];
                        long total = 0;
                        int read;
                        while (total < fileSize && (read = dataIn.read(buffer)) > 0) {
                            fos.write(buffer, 0, read);
                            total += read;
                        }
                        fos.close();
                        out.println("UPLOAD DONE");

                    } else if (command.equalsIgnoreCase("EXIT")) {
                        out.println("T·∫°m bi·ªát!");
                        break;
                    } else {
                        out.println("L·ªánh kh√¥ng h·ª£p l·ªá.");
                    }
                }

                socket.close();
            } catch (IOException e) {
                System.out.println("L·ªói client: " + e.getMessage());
            }
        }
    }
}
            </code></pre>

            <h3>FTPClient.java</h3>
            <pre><code>
import java.io.*;
import java.net.*;

public class FTPClient {
    public static void main(String[] args) throws IOException {
        Socket socket = new Socket("localhost", 2121);
        BufferedReader userInput = new BufferedReader(new InputStreamReader(System.in));
        BufferedReader in = new BufferedReader(new InputStreamReader(socket.getInputStream()));
        PrintWriter out = new PrintWriter(socket.getOutputStream(), true);
        DataInputStream dataIn = new DataInputStream(socket.getInputStream());
        DataOutputStream dataOut = new DataOutputStream(socket.getOutputStream());

        System.out.println(in.readLine());

        String command;
        while (true) {
            System.out.print("ftp> ");
            command = userInput.readLine();
            out.println(command);

            if (command.equalsIgnoreCase("EXIT")) break;

            if (command.equalsIgnoreCase("LIST")) {
                String response;
                while ((response = in.readLine()) != null && !response.equals("DONE")) {
                    System.out.println(response);
                    if (!in.ready()) break;
                }

            } else if (command.startsWith("GET ")) {
                String filename = command.substring(4).trim();
                String status = in.readLine();
                if (status.startsWith("SENDING")) {
                    long fileSize = Long.parseLong(status.split(" ")[1]);
                    FileOutputStream fos = new FileOutputStream("download_" + filename);
                    byte[] buffer = new byte[4096];
                    int read;
                    long total = 0;
                    while (total < fileSize && (read = dataIn.read(buffer)) > 0) {
                        fos.write(buffer, 0, read);
                        total += read;
                    }
                    fos.close();
                    System.out.println("T·∫£i file ho√†n t·∫•t.");
                } else {
                    System.out.println(status);
                }

            } else if (command.startsWith("PUT ")) {
                String filename = command.substring(4).trim();
                File file = new File(filename);
                if (!file.exists()) {
                    System.out.println("File kh√¥ng t·ªìn t·∫°i c·ª•c b·ªô.");
                    continue;
                }

                String ready = in.readLine();
                if (ready.equals("READY")) {
                    out.println(file.length());
                    FileInputStream fis = new FileInputStream(file);
                    byte[] buffer = new byte[4096];
                    int read;
                    while ((read = fis.read(buffer)) > 0) {
                        dataOut.write(buffer, 0, read);
                    }
                    fis.close();
                    System.out.println(in.readLine());
                }
            }
        }

        socket.close();
        System.out.println("ƒê√£ ng·∫Øt k·∫øt n·ªëi kh·ªèi server.");
    }
}
            </code></pre>
        </section>

        <section>
            <h2>4. K·∫øt qu·∫£ v√† ki·ªÉm th·ª≠</h2>
            <p>
                Sau khi ch·∫°y server v√† client, b·∫°n c√≥ th·ªÉ th·ª≠:
            </p>
            <ul>
                <li><code>LIST</code> ‚Üí hi·ªÉn th·ªã danh s√°ch file tr√™n server.</li>
                <li><code>PUT test.txt</code> ‚Üí g·ª≠i file <code>test.txt</code> t·ª´ m√°y client l√™n server.</li>
                <li><code>GET example.txt</code> ‚Üí t·∫£i file t·ª´ server v·ªÅ m√°y client.</li>
                <li><code>EXIT</code> ‚Üí tho√°t k·∫øt n·ªëi.</li>
            </ul>
            <p>
                K·∫øt qu·∫£ hi·ªÉn th·ªã r√µ r√†ng trong terminal, gi√∫p ki·ªÉm ch·ª©ng ho·∫°t ƒë·ªông c·ªßa t·ª´ng l·ªánh.
            </p>
        </section>

        <section>
            <h2>5. K·∫øt lu·∫≠n</h2>
            <p>
                Mini FTP Server l√† m√¥ h√¨nh thu nh·ªè c·ªßa h·ªá th·ªëng FTP th·ª±c t·∫ø.  
                T·ª´ ƒë√¢y, b·∫°n c√≥ th·ªÉ m·ªü r·ªông th√™m:
            </p>
            <ul>
                <li>Th√™m x√°c th·ª±c ƒëƒÉng nh·∫≠p (username / password).</li>
                <li>Th√™m t√≠nh nƒÉng ƒëa lu·ªìng ƒë·ªÉ nhi·ªÅu client c√πng truy c·∫≠p.</li>
                <li>M√£ h√≥a d·ªØ li·ªáu khi truy·ªÅn ƒë·ªÉ ƒë·∫£m b·∫£o b·∫£o m·∫≠t.</li>
                <li>T·∫°o giao di·ªán ƒë·ªì h·ªça qu·∫£n l√Ω file.</li>
            </ul>
            <p>
                ƒê√¢y l√† n·ªÅn t·∫£ng quan tr·ªçng ƒë·ªÉ b∆∞·ªõc sang ph·∫ßn ti·∫øp theo ‚Äî 
                <b>m√£ h√≥a, b·∫£o m·∫≠t v√† t·ªëi ∆∞u h√≥a truy·ªÅn d·ªØ li·ªáu qua m·∫°ng trong Java</b>.
            </p>
        </section>
    </main>

    <footer>
        <p><i>¬© 2025 - Blog L·∫≠p Tr√¨nh M·∫°ng v·ªõi Java</i></p>
    </footer>
</body>
</html>
